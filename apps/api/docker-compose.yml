services:
    api:
        image: api:latest
        build:
            dockerfile: apps/api/Dockerfile
            context: ../../
            target: development
            args:
                USER_ID: 1000
                GROUP_ID: 1000
        restart: on-failure
        ports:
            - 8080:8080
        volumes:
            - .:/var/www/html
        depends_on:
            - db
            - redis
        environment:
            AUTORUN_ENABLED: true
    redis:
        restart: on-failure
        image: redis:latest
        ports:
            - 6379:6379
    db:
        restart: on-failure
        image: mariadb:latest
        ports:
            - 3306:3306
        environment:
            MYSQL_ROOT_PASSWORD: root
            MYSQL_DATABASE: app
            MYSQL_USER: app
            MYSQL_PASSWORD: app
    mailpit:
        restart: on-failure
        image: axllent/mailpit:latest
        ports:
            - 1025:1025
            - 8025:8025
